<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>I LOVE U</title>
		<style>
			* {
				margin: 0;
				padding: 0;
			}

			body {
				overflow: hidden;
				background: transparent;
			}

			/* 统一设置所有 canvas 的样式 */
			canvas {
				position: absolute;
				width: 100%;
				height: 100%;
				border: none;
				background: transparent;
			}

			/* 如果需要特定的 z-index */
			.canvas {
				z-index: 9999;
			}
		</style>
	</head>
	<body>
		<canvas class="canvas"></canvas>
		<script src="js/index.js"></script>
		<canvas id="canvas">  </canvas>
		<script>
			var drawInterval; // 定义一个变量来存储 setInterval 的返回值

			// 页面加载时直接调用 S.init
			if (typeof S !== 'undefined' && typeof S.init === 'function') {
				S.init();
			} else {
				console.error("S or S.init is not defined.");
			}

			const userAgent = navigator.userAgent || navigator.vendor || window.opera;
			var canvas = document.getElementById("canvas");
			var can = canvas.getContext("2d");

			// 更新 canvas 尺寸的函数
			function updateCanvasSize() {
				w = canvas.width = window.innerWidth;
				h = canvas.height = window.innerHeight;
				// 同时更新文字 canvas 的尺寸
				document.querySelector('.canvas').width = window.innerWidth;
				document.querySelector('.canvas').height = window.innerHeight;
			}

			// 初始化尺寸
			updateCanvasSize();

			// 监听窗口大小变化
			window.addEventListener('resize', updateCanvasSize);

			var textColor = '#6B0536';  // 直接定义颜色变量

			can.fillStyle = textColor;
			if (/Windows/i.test(userAgent)) can.font="16px 微软雅黑";
			if (/iPhone/i.test(userAgent)) can.font="20px 微软雅黑";

			var words = Array(256).join("1").split("");

			// 将原来的 setInterval 替换为
			drawInterval = setInterval(draw, 50);

			function draw() {
				can.fillStyle = 'rgba(0,0,0,0.05)';
				can.fillRect(0, 0, w, h);
				can.fillStyle = textColor;  // 使用定义的颜色变量
				words.map(function(y, n) {
					var chars = "ILOVEYOU❤️";
					text = chars.charAt(Math.floor(Math.random() * chars.length));
					x = n * 10;
					can.fillText(text, x, y)
					if (/Windows/i.test(userAgent)) words[n] = (y > (h / 2) + Math.random() * w ? 0 : y + 16);
					if (/iPhone/i.test(userAgent)) words[n] = (y > (h / 2) + Math.random() * w ? 0 : y + 20);
				});
			}

			// 在 updateCanvasSize 函数后添加
			function requestFullScreen() {
				var element = document.documentElement;
				if (element.requestFullscreen) {
					element.requestFullscreen();
				} else if (element.mozRequestFullScreen) {
					element.mozRequestFullScreen();
				} else if (element.webkitRequestFullscreen) {
					element.webkitRequestFullscreen();
				} else if (element.msRequestFullscreen) {
					element.msRequestFullscreen();
				}
			}

			// 可以在页面加载时或者用户点击时调用
			document.addEventListener('click', requestFullScreen);
		</script>
	</body>
</html>